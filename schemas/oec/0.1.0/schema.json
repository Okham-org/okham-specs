{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://okham.org/schemas/oec/0.1.0/schema.json",
  "title": "OEC Event Definition",
  "description": "DRAFT v0.0.1 schema for Open Event Contract (OEC).",
  "type": "object",
  "required": ["event", "id", "name", "version", "status", "source", "timestamp", "payload"],
  "properties": {
    "event": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "OEC version (semantic version)."
    },
    "id": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9._-]*[a-z0-9]$",
      "description": "Event identifier (unique, namespaced)."
    },
    "name": {
      "type": "string",
      "minLength": 2,
      "maxLength": 100,
      "description": "Human-readable event name (past tense)."
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Event schema version."
    },
    "status": {
      "type": "string",
      "enum": ["draft", "stable", "deprecated", "removed"],
      "description": "Lifecycle status."
    },
    "source": {
      "type": "object",
      "required": ["capability"],
      "properties": {
        "capability": {
          "type": "string",
          "description": "OCC capability ID that emitted the event."
        },
        "instance": {
          "type": "string",
          "description": "Instance ID of the emitting capability."
        },
        "version": {
          "type": "string",
          "description": "Version of the emitting capability (semver)."
        }
      },
      "additionalProperties": true
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Event occurrence time (ISO 8601, UTC)."
    },
    "causality": {
      "type": "object",
      "properties": {
        "correlation_id": { "type": "string" },
        "causation_id": { "type": "string" },
        "trace_id": { "type": "string" },
        "span_id": { "type": "string" }
      },
      "additionalProperties": true
    },
    "classification": {
      "type": "object",
      "properties": {
        "domain": { "type": "string" },
        "lifecycle": { "type": "string" },
        "severity": {
          "type": "string",
          "enum": ["debug", "info", "warn", "error", "critical"]
        },
        "scope": {
          "type": "string",
          "enum": ["public", "internal", "private"]
        },
        "category": { "type": "string" }
      },
      "additionalProperties": true
    },
    "payload": {
      "type": "object",
      "required": ["type", "data"],
      "properties": {
        "type": {
          "type": "string",
          "description": "OTC type URL or reference (versioned)."
        },
        "data": {
          "type": "object",
          "description": "Event data (must conform to type).",
          "additionalProperties": true
        }
      },
      "additionalProperties": true
    },
    "metadata": {
      "type": "object",
      "additionalProperties": true
    }
  },
  "additionalProperties": true
}
